
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="The Jython Evaluator processes data based on custom Jython code. Use the Jython Evaluator to incorporate custom Jython code in a pipeline. The Jython Evaluator supports Jython version 2.7. The Jython ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="copyright" content="(C) Copyright 2005"></meta><meta name="DC.rights.owner" content="(C) Copyright 2005"></meta><meta name="DC.Type" content="concept"></meta><meta name="DC.Title" content="Jython Evaluator"></meta><meta name="abstract" content="The Jython Evaluator processes data based on custom Jython code. Use the Jython Evaluator to incorporate custom Jython code in a pipeline. The Jython Evaluator supports Jython version 2.7."></meta><meta name="description" content="The Jython Evaluator processes data based on custom Jython code. Use the Jython Evaluator to incorporate custom Jython code in a pipeline. The Jython Evaluator supports Jython version 2.7."></meta><meta name="DC.Relation" scheme="URI" content="../Processors/Processors_title.html"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="concept_a1h_lkf_lr"></meta><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Jython Evaluator</title><!--  Generated with Oxygen version 17.1, build number 2016020417.  --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/skins/skin.css"><!----></link><link rel="stylesheet" type="text/css" href="../skin.css"></link><script type="text/javascript"><!--
          
          var prefix = "../index.html";
          
          --></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script><!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--></head>
<body onload="highlightSearchTerm()" class="frmBody">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="../Processors/Processors_title.html" title="Processors">Processors</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="../Processors/Processors_title.html" title="Processors"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Processors</span></a></span>  </div></td></tr></tbody></table>
<div class="nested0" id="concept_a1h_lkf_lr">
 <h1 class="title topictitle1">Jython Evaluator</h1>

 
 <div class="body conbody"><p class="shortdesc">The Jython Evaluator processes data based on custom Jython code. Use the Jython
  Evaluator to incorporate custom Jython code in a pipeline. The Jython Evaluator supports Jython
  version 2.7.</p>

  <p class="p">The Jython Evaluator can process data one record at a
      time or one batch at a time. </p>

  <p class="p">When you use a Jython Evaluator in a pipeline, the <span class="ph">Data
                  Collector</span> passes a
      batch of data to the processor and converts the data to a scripting-friendly data structure
      for processing.</p>

 </div>

<div class="related-links"></div>
<div class="topic concept nested1" id="concept_j1t_ntc_pr">
 <h2 class="title topictitle2">Processing Mode</h2>

  
 <div class="body conbody"><p class="shortdesc">You can choose the processing mode to use with the Jython Evaluator. You can use the
    same script in each processing mode. However, you should include error handling in the script
    before you run in batch mode.</p>

    <div class="p">The Jython Evaluator provides the following processing modes:<dl class="dl">
            
                              <dt class="dt dlterm">Record by Record</dt>

                              <dd class="dd">The processor calls the script for each record. The processor
                                    passes the record to the script as a map and processes each
                                    record individually. </dd>

                              <dd class="dd">The script does not require error handling logic. Error records
                                    are passed to the processor for error handling. The processor
                                    handles error records based on the On Record Error
                                    property.</dd>

                              <dd class="dd">Use this mode to avoid including error handling logic in the code.
                                    Since this mode calls the script for each record, pipeline
                                    performance will be negatively affected. </dd>

                        
            
                              <dt class="dt dlterm">Batch by Batch</dt>

                              <dd class="dd">The processor calls the script for each batch. The processor
                                    passes the batch to the script as a list and processes the batch
                                    at one time. </dd>

                              <dd class="dd">Include error handling logic in the script. Without error handling
                                    logic, a single error record sends the entire batch to the
                                    processor for error handling. The processor handles error
                                    records based on the On Record Error property.</dd>

                              <dd class="dd">Use this mode to improve performance by processing a batch of data
                                    at a time.</dd>

                        
          </dl>
</div>

 </div>

</div>
<div class="topic concept nested1" id="concept_mqn_5vk_sr">
 <h2 class="title topictitle2">Jython Scripting Objects</h2>

 <div class="body conbody">
  <div class="p">You can use the following scripting objects in the Jython
        Evaluator:<dl class="dl">
        
          <dt class="dt dlterm">records</dt>

          <dd class="dd">A collection of records to process. The records object includes different elements
            based on the processing mode that you use:<ul class="ul" id="concept_mqn_5vk_sr__ul_fdm_5yk_sr">
              <li class="li">Record by Record - The records array includes one record element. A record
                includes a single <samp class="ph codeph">value</samp> element. The <samp class="ph codeph">value</samp> element
                contains the data for the record.</li>

              <li class="li">Batch by Batch - The records array includes all records in the batch.</li>

            </ul>
</dd>

          <dd class="dd">Map and list record fields are mapped to Jython dictionaries and lists,
            respectively.</dd>

          <dd class="dd">Data types are preserved for values that are not modified. For values that are
            modified, the scripting engine might change the original type.</dd>

        
      </dl>
<dl class="dl">
                        
                              <dt class="dt dlterm">state</dt>

                              <dd class="dd">An object to store information between invocations of this script.
                                    A state is a map object that includes a collection of key/value
                                    pairs. You can use the state object to cache data such as
                                    lookups or counters.</dd>

                              <dd class="dd">The state object functions much like an instance variable: <ul class="ul" id="concept_mqn_5vk_sr__d25036e1098">
                                          <li class="li">You need to populate the object - it has no default
                                                value.</li>

                                          <li class="li">The information is transient and is lost when the
                                                pipeline stops or restarts.</li>

                                          <li class="li">The state object is available only for the instance of
                                                the processor stage it is defined in. If the
                                                pipeline executes in cluster mode, the state object
                                                is not shared across nodes.</li>

                                    </ul>
</dd>

                              <dd class="dd">
                                    <div class="note warning"><span class="warningtitle">Warning:</span> The state object is best used for a fixed
                                          or static set of data. Adding to the cache on every record
                                          or batch can quickly consume the memory allocated to <span class="ph">Data
                  Collector</span> and cause
                                          out of memory exceptions. </div>

                              </dd>

                        
                        
                              <dt class="dt dlterm">log</dt>

                              <dd class="dd">An object to write messages to the log. Includes four methods:
                                          <samp class="ph codeph">info()</samp>, <samp class="ph codeph">warn()</samp>,
                                          <samp class="ph codeph">debug()</samp>, and <samp class="ph codeph">trace()</samp>. </dd>

                              <dd class="dd">The signature of the four methods is as follows:
                                    <pre class="pre codeblock">(message-template, arguments...) </pre>
The
                                    message template can have positional variables denoted by curly
                                    brackets: { }. The arguments are replaced in the message
                                    template curly brackets in positional manner, i.e., this is the
                                    first argument in the first { } occurrence, and so on.</dd>

                        
                        
                              <dt class="dt dlterm">output</dt>

                              <dd class="dd">An object that writes the record to the output batch. Includes a
                                          <samp class="ph codeph">write(Record)</samp> method.</dd>

                        
                        
                              <dt class="dt dlterm">error</dt>

                              <dd class="dd">An object that passes error records to the processor for error
                                    handling. Includes a <samp class="ph codeph">write(Record, message)</samp>
                                    method.</dd>

                        
                        
                              <dt class="dt dlterm">sdcFunctions</dt>

                              <dd class="dd">An object that runs functions that evaluate or modify data.
                                    Includes a <samp class="ph codeph">getFieldNull(Record, 'field path')</samp>
                                    method that checks if a field is assigned a constant such as
                                    NULL_INTEGER or NULL_STRING. </dd>

                        
                  </dl>
</div>

 </div>

</div>
<div class="topic concept nested1" id="concept_a1r_5qj_b5">
 <h2 class="title topictitle2">Processing List-Map Data</h2>

 
 <div class="body conbody"><p class="shortdesc">In scripts that process list-map data, treat the data as maps. </p>

        <p class="p">List-Map is a <span class="ph">Data
                  Collector</span>
            data type that allows you to use standard record functions to work with delimited data.
            When an origin reads delimited data, it generates List-Map fields by default. </p>

        <p class="p">The Jython Evaluator reads and passes list-map data. But to process data in a List-Map
            field, treat the field as a Map in the script.</p>

 </div>

</div>
<div class="topic concept nested1" id="concept_szj_slw_tr">
    <h2 class="title topictitle2">Type Handling</h2>

    <div class="body conbody">
        <p class="p">Though Jython does not use type information
            when processing data, passing data to the rest of the pipeline requires data types. </p>

        <div class="p">Note the following type information before you configure the remainder of the pipeline: <dl class="dl">
                
                    <dt class="dt dlterm">Data type of null values</dt>

                    <dd class="dd">The Jython Evaluator can associate null values with a data type. For
                        example, if the Jython Evaluator assigns a null value to an Integer field,
                        the field is returned to the pipeline as an integer with a null value.</dd>

                    <dd class="dd">Use constants in the Jython code to create a new field of a specific data
                        type with a null value. For example, you can create a new String field with
                        a null value by assigning the type constant NULL_STRING to the field as
                        follows:<pre class="pre codeblock">record.value['new_field'] = NULL_STRING</pre>
</dd>

                
                
                    <dt class="dt dlterm">Date fields</dt>

                    <dd class="dd">Use the String data type to create a new field to store a date with a
                        specific format. For example, the following sample code creates a new String
                        field that stores the current date using the format
                        YYYY-MM-dd:<pre class="pre codeblock"># Define a date object to record the current date
import datetime as dt
newDate = dt.datetime.utcnow().strftime("%Y-%m-%d")

for record in records:
  try:
    # Create a string field to store the current date with the specified format
    record.value["date"] = newDate
    
    # Write record to processor output
    output.write(record)

  except Exception as e:
    # Send record to error
    error.write(record, str(e))</pre>
</dd>

                
                
                    <dt class="dt dlterm">Data type of modified values</dt>

                    <dd class="dd">Values that are not modified in the processor retain their original
                        type.</dd>

                    <dd class="dd">Numeric data that is modified becomes a Double, other types of data retain
                        their original type.</dd>

                
            </dl>
</div>

    </div>

</div>
<div class="topic task nested1" id="task_fty_jwx_nr">
    <h2 class="title topictitle2">Configuring a Jython Evaluator</h2>

    <div class="body taskbody">
        <div class="section context">
            <p class="p">Configure a Jython Evaluator
                to use custom Jython code in a pipeline.</p>

        </div>

        <ol class="ol steps" id="task_fty_jwx_nr__steps_q2n_hxx_nr"><li class="li step stepexpand">
                <span class="ph cmd">In the Properties panel, on the <span class="keyword wintitle">General</span> tab, configure the
                    following properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_fty_jwx_nr__d24974e3197" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr class="row">
                                    <th class="entry" valign="top" width="30%" id="d186766e390">General Property</th>

                                    <th class="entry" valign="top" width="70%" id="d186766e393">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d186766e390 ">Name</td>

                                    <td class="entry" valign="top" width="70%" headers="d186766e393 ">Stage name.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d186766e390 ">Description</td>

                                    <td class="entry" valign="top" width="70%" headers="d186766e393 ">Optional description.</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d186766e390 ">Required Fields <a class="xref" href="../Pipeline_Design/DroppingUnwantedRecords.html#concept_dnj_bkm_vq" title="A required field is a field that must exist in a record to allow it into the stage for processing. When a record does not include a required field, the record is diverted to the pipeline for error handling. You can define required fields for any processor and most destination stages.">
                                            <img class="image" id="task_fty_jwx_nr__d24974e3243" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d186766e393 ">Fields that must include data to be passed into the
                                        stage. <div class="note tip"><span class="tiptitle">Tip:</span> You might include
                                            fields that the stage uses.</div>
</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d186766e390 ">Preconditions <a class="xref" href="../Pipeline_Design/DroppingUnwantedRecords.html#concept_msl_yd4_fs" title="Preconditions are conditions that a record must satisfy to enter the stage for processing. Like required fields, if a record does not meet a precondition, it is diverted to the pipeline for error handling. You can define preconditions for any processor and most destination stages.">
                                            <img class="image" id="task_fty_jwx_nr__d24974e3257" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d186766e393 ">Conditions that must evaluate to TRUE to allow a record
                                        to enter the stage for processing. Click
                                            <span class="ph uicontrol">Add</span> to create additional
                                        preconditions. </td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="30%" headers="d186766e390 ">On Record Error <a class="xref" href="../Pipeline_Design/ErrorHandling.html#concept_atr_j4y_5r" title="Most stages include error record handling options. When an error occurs when processing a record, Data Collector processes records based on the On Record Error property for the stage.">
                                            <img class="image" id="task_fty_jwx_nr__d24974e3272" src="../Reusable_Content/../Graphics/icon_moreInfo.png" height="12" width="12"></img></a></td>

                                    <td class="entry" valign="top" width="70%" headers="d186766e393 ">Error record handling for the stage: <ul class="ul" id="task_fty_jwx_nr__d24974e3276">
                                            <li class="li">Discard - Discards the record.</li>

                                            <li class="li">Send to Error - Sends the record to the pipeline for
                                                error handling.</li>

                                            <li class="li">Stop Pipeline - Stops the pipeline. Not valid for
                                                cluster pipelines.</li>

                                        </ul>
</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">On the <span class="keyword wintitle">Jython</span> tab, configure the following
                    properties:</span>
                <div class="itemgroup info">
                    
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="task_fty_jwx_nr__table_wvy_4xx_nr" class="table" frame="border" border="1" rules="all">
                            
                            
                            <thead class="thead" align="left">
                                <tr class="row">
                                    <th class="entry" valign="top" width="22.22222222222222%" id="d186766e512">Jython Evaluator Property</th>

                                    <th class="entry" valign="top" width="77.77777777777779%" id="d186766e515">Description</th>

                                </tr>

                            </thead>

                            <tbody class="tbody">
                                <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" headers="d186766e512 ">Record Processing Mode</td>

                                    <td class="entry" valign="top" width="77.77777777777779%" headers="d186766e515 ">Determines how the Jython Evaluator processes data:<ul class="ul" id="task_fty_jwx_nr__ul_tzg_vzx_nr">
                                            <li class="li">Record by Record - Processes records individually.
                                                Performs error handling.</li>

                                            <li class="li">Batch by Batch - Processes records in batches.
                                                Requires error handling code in the script.</li>

                                        </ul>
<p class="p">Default is Batch by Batch.</p>
</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry" valign="top" width="22.22222222222222%" headers="d186766e512 ">Script</td>

                                    <td class="entry" valign="top" width="77.77777777777779%" headers="d186766e515 ">Jython code to use in the processor.</td>

                                </tr>

                            </tbody>

                        </table>
</div>

                </div>
            </li>
</ol>

    </div>

</div>
</div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../Processors/Processors_title.html" title="Processors"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Processors</span></a></span>  </div><div class="footer"><!-- SDC google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60917135-3', 'auto');
  ga('send', 'pageview');
</script></div>
</body>
</html>